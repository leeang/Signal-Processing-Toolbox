clear;

dataset = 1;

% youdao-type3-21
MATLAB{21} = [-748.558524942301 -693.591502676118 -794.413999311685 -791.078896434326 -807.180198767299 -820.267720641463 -729.856606906899 -881.475606812735 -732.690408195949 -824.839418112333 -755.016950339232 -797.975941257253 -784.797584825466 -792.878531789262 -895.462984087828 -828.797701182304 -809.271975503981 -908.269920249795 -758.972105417584 -855.478531793776 -589.097923434755 -831.625627497508 -969.644047720905 -753.803513342183 -822.526347905483 -779.075395777941 -1115.52768152416];
DSP{21} = [-748.564200 -693.595150 -794.417950 -791.080150 -807.182550 -820.270200 -729.859800 -881.480300 -732.693800 -824.843700 -755.019800 -797.981300 -784.800150 -792.881000 -895.467200 -828.803050 -809.274500 -908.275100 -758.975050 -855.480800 -589.101850 -831.627700 -969.648400 -753.807200 -822.531900 -779.078850 -1115.544750];

% google-us-1
MATLAB{1} = [-443.811100541301 -541.560829476760 -648.512214274635 -593.188557711772 -504.012934822681 -603.955773071711 -492.207876032275 -616.847395566047 -521.217789546876 -487.671306218634 -510.715641034388 -518.286155736386 -585.304882334850 -492.253123226250 -659.848970760347 -639.741921562641 -517.282477240267 -689.522032390477 -533.535970689294 -463.893766327539 -620.214849389523 -538.159019617721 -654.342920850821 -490.902252605813 -679.652123578363 -530.971074486610 -977.325672887499];

% google-us-2
MATLAB{2} = [-540.828032340694 -401.299451702444 -494.938746468338 -633.803416696150 -514.130063233441 -453.005322659858 -485.301471466521 -510.950164946921 -480.844307690071 -526.469166993976 -465.200355965955 -642.948994228060 -512.479843235913 -467.155526799932 -416.662577095022 -456.551473787028 -466.740653031872 -449.342807833905 -493.864321657422 -508.577177402494 -468.672416663466 -618.093841153071 -777.965649515714 -460.232268505522 -487.595917450746 -514.476129753923 -820.666622244221];

% google-us-3
MATLAB{3} = [-592.531646625732 -475.018947080569 -372.565448852979 -704.540839982861 -496.840471412068 -483.818555971323 -481.546645115847 -449.779249119362 -469.940271481365 -524.235521211037 -473.425105153337 -590.890921736783 -449.345346310026 -475.684419815366 -468.832316711623 -489.908803221377 -431.892384299820 -496.298089389256 -408.388211276211 -405.392912363335 -502.129151059257 -612.545019020367 -740.099117503829 -477.478548930425 -499.448744354354 -466.928644324678 -706.722180738910];

% google-us-4
MATLAB{4} = [-414.179116570208 -435.789086865825 -539.745281895809 -337.278463818801 -451.419235437790 -485.932829081806 -432.825946073207 -492.636896749880 -462.302098141416 -509.308900900241 -463.663042781258 -452.164360157501 -449.558040991233 -385.534048629528 -528.383803927764 -523.175655654956 -529.240243708308 -584.574666793031 -472.937203093485 -429.151497227157 -438.446630532366 -436.648771851939 -487.145416155248 -415.063185876155 -499.708811817514 -421.019957551448 -787.626137085605];

% google-us-5
MATLAB{5} = [-409.351284373683 -502.893942193927 -466.757148603304 -528.414164949747 -321.599932230681 -514.492953254533 -419.326350328180 -477.996968147733 -336.849482892996 -452.698610689923 -445.951596862699 -439.747481857373 -426.242238370998 -443.244823014767 -558.904318665257 -609.649595429706 -535.343679913397 -608.637759668472 -453.291682650881 -418.105937696333 -482.866930949772 -470.788277225461 -487.774722719631 -443.387654605357 -503.899033531769 -428.535557494405 -521.854973166562];

% google-us-6
MATLAB{6} = [-363.367163780156 -340.649934182136 -332.780200430076 -488.728929884073 -311.764571796751 -255.321903598776 -334.881280134630 -288.514192753708 -337.034107058811 -339.333879277105 -340.547141627222 -407.333799952915 -315.664472826664 -306.614055532840 -321.033069994806 -283.578954408702 -321.475193557141 -316.323866502971 -328.786713830311 -360.939412206484 -313.570070063790 -388.893902299988 -446.178236788315 -336.366434313873 -268.501077302759 -399.497053117905 -641.882870245004];

percent_error = (DSP{dataset}-MATLAB{dataset}) ./ MATLAB{dataset};

fig = figure;
fig.Units = 'inches';
pos = fig.Position;
fig.PaperSize = [pos(3) pos(4)];
fig.PaperPositionMode = 'Auto';

subplot(2, 1, 1);
plot(MATLAB{dataset});
title('probabilities of 27 words computed by MATLAB', 'interpreter', 'latex');
xlabel(['word 1 to word 27 (dataset' num2str(dataset) ')'], 'interpreter', 'latex');
ylabel('probabilities', 'interpreter', 'latex');
grid on;
ax = gca;
ax.XTick = linspace(0, 27, 10);
xlim([0 28]);

subplot(2, 1, 2);
plot(DSP{dataset});
title('probabilities of 27 words computed by DSP', 'interpreter', 'latex');
xlabel(['word 1 to word 27 (dataset' num2str(dataset) ')'], 'interpreter', 'latex');
ylabel('probabilities', 'interpreter', 'latex');
grid on;
ax = gca;
ax.XTick = linspace(0, 27, 10);
xlim([0 28]);

print(['probability_comparison_' num2str(dataset)], '-dpdf');

fig = figure;
fig.Units = 'inches';
pos = fig.Position;
fig.PaperSize = [pos(3) pos(4)];
fig.PaperPositionMode = 'Auto';

plot(percent_error);
title('relative error between probabilities computed by MATLAB and DSP', 'interpreter', 'latex');
xlabel(['word 1 to word 27 (dataset' num2str(dataset) ')'], 'interpreter', 'latex');
ylabel('$\frac{DSP - MATLAB}{MATLAB}$', 'interpreter', 'latex');
grid on;
ax = gca;
ax.XTick = linspace(0, 27, 10);
xlim([0 28]);

print(['probability_error_' num2str(dataset)], '-dpdf');

return;

for word_index = 1:27
	fprintf('%f\t', MATLAB(word_index));
end
fprintf('\n');

for word_index = 1:27
	fprintf('%f\t', DSP(word_index));
end
fprintf('\n');
