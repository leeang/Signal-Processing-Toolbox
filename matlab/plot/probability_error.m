clear;

dataset = 1;

% google-us-1

% google-us-2
% Clocks: 47675736
% Time elapsed: 79.459555 ms
MATLAB{2} = [-540.828032340694 -401.299451702444 -494.938746468338 -633.803416696150 -514.130063233441 -453.005322659858 -485.301471466521 -510.950164946921 -480.844307690071 -526.469166993976 -465.200355965955 -642.948994228060 -512.479843235913 -467.155526799932 -416.662577095022 -456.551473787028 -466.740653031872 -449.342807833905 -493.864321657422 -508.577177402494 -468.672416663466 -618.093841153071 -777.965649515714 -460.232268505522 -487.595917450746 -514.476129753923 -820.666622244221];
DSP{2} = [-540.658400 -401.179750 -494.739050 -633.688600 -513.819600 -452.838000 -485.126850 -510.754150 -480.670550 -526.261900 -465.023300 -642.693550 -512.214000 -466.922750 -416.462275 -456.317450 -466.487250 -449.172150 -493.581700 -508.344100 -468.432900 -617.904500 -777.703050 -460.116100 -487.407050 -514.278500 -820.539800];

% google-us-3
% Clocks: 50877280
% Time elapsed: 84.795460 ms
MATLAB{3} = [-592.531646625732 -475.018947080569 -372.565448852979 -704.540839982861 -496.840471412068 -483.818555971323 -481.546645115847 -449.779249119362 -469.940271481365 -524.235521211037 -473.425105153337 -590.890921736783 -449.345346310026 -475.684419815366 -468.832316711623 -489.908803221377 -431.892384299820 -496.298089389256 -408.388211276211 -405.392912363335 -502.129151059257 -612.545019020367 -740.099117503829 -477.478548930425 -499.448744354354 -466.928644324678 -706.722180738910];
DSP{3} = [-592.541200 -475.019400 -372.568875 -704.544350 -496.843850 -483.832850 -481.548800 -449.765550 -469.930350 -524.237900 -473.423650 -590.889350 -449.347300 -475.685600 -468.839250 -489.901450 -431.889150 -496.311850 -408.387500 -405.391325 -502.137700 -612.538400 -740.099600 -477.474750 -499.465550 -466.935600 -706.751300];

% google-us-4

% google-us-5

% google-us-6
% Clocks: 42396444
% Time elapsed: 70.660735 ms
MATLAB{6} = [-363.367163780156 -340.649934182136 -332.780200430076 -488.728929884073 -311.764571796751 -255.321903598776 -334.881280134630 -288.514192753708 -337.034107058811 -339.333879277105 -340.547141627222 -407.333799952915 -315.664472826664 -306.614055532840 -321.033069994806 -283.578954408702 -321.475193557141 -316.323866502971 -328.786713830311 -360.939412206484 -313.570070063790 -388.893902299988 -446.178236788315 -336.366434313873 -268.501077302759 -399.497053117905 -641.882870245004];
DSP{6} = [-363.355525 -340.638375 -332.767650 -488.702400 -311.753425 -255.313900 -334.872800 -288.507300 -337.026800 -339.324225 -340.538625 -407.323050 -315.656000 -306.603825 -321.022150 -283.566650 -321.463375 -316.312550 -328.775025 -360.931825 -313.558725 -388.885925 -446.166650 -336.351675 -268.491475 -399.489050 -641.860800];

% youdao-type3-21
% Clocks: 64710920
% Time elapsed: 107.851525 ms
MATLAB{21} = [-748.558524942301 -693.591502676118 -794.413999311685 -791.078896434326 -807.180198767299 -820.267720641463 -729.856606906899 -881.475606812735 -732.690408195949 -824.839418112333 -755.016950339232 -797.975941257253 -784.797584825466 -792.878531789262 -895.462984087828 -828.797701182304 -809.271975503981 -908.269920249795 -758.972105417584 -855.478531793776 -589.097923434755 -831.625627497508 -969.644047720905 -753.803513342183 -822.526347905483 -779.075395777941 -1115.52768152416];
DSP{21} = [-748.564200 -693.595150 -794.417950 -791.080150 -807.182550 -820.270200 -729.859800 -881.480300 -732.693800 -824.843700 -755.019800 -797.981300 -784.800150 -792.881000 -895.467200 -828.803050 -809.274500 -908.275100 -758.975050 -855.480800 -589.101850 -831.627700 -969.648400 -753.807200 -822.531900 -779.078850 -1115.544750];

percent_error = (DSP{dataset}-MATLAB{dataset}) ./ MATLAB{dataset};

fig = figure;
fig.Units = 'inches';
pos = fig.Position;
fig.PaperSize = [pos(3) pos(4)];
fig.PaperPositionMode = 'Auto';

subplot(2, 1, 1);
plot(MATLAB{dataset});
title('probabilities of 27 words computed by MATLAB', 'interpreter', 'latex');
xlabel(['word 1 to word 27 (dataset' num2str(dataset) ')'], 'interpreter', 'latex');
ylabel('probabilities', 'interpreter', 'latex');
grid on;
ax = gca;
ax.XTick = linspace(0, 27, 10);
xlim([0 28]);

subplot(2, 1, 2);
plot(DSP{dataset});
title('probabilities of 27 words computed by DSP', 'interpreter', 'latex');
xlabel(['word 1 to word 27 (dataset' num2str(dataset) ')'], 'interpreter', 'latex');
ylabel('probabilities', 'interpreter', 'latex');
grid on;
ax = gca;
ax.XTick = linspace(0, 27, 10);
xlim([0 28]);

print(['probability_comparison_' num2str(dataset)], '-dpdf');

fig = figure;
fig.Units = 'inches';
pos = fig.Position;
fig.PaperSize = [pos(3) pos(4)];
fig.PaperPositionMode = 'Auto';

plot(percent_error);
title('relative error between probabilities computed by MATLAB and DSP', 'interpreter', 'latex');
xlabel(['word 1 to word 27 (dataset' num2str(dataset) ')'], 'interpreter', 'latex');
ylabel('$\frac{DSP - MATLAB}{MATLAB}$', 'interpreter', 'latex');
grid on;
ax = gca;
ax.XTick = linspace(0, 27, 10);
xlim([0 28]);

print(['probability_error_' num2str(dataset)], '-dpdf');

return;

for word_index = 1:27
	fprintf('%f\t', MATLAB(word_index));
end
fprintf('\n');

for word_index = 1:27
	fprintf('%f\t', DSP(word_index));
end
fprintf('\n');
